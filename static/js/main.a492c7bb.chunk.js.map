{"version":3,"sources":["api/TDX/getAuthorizationHeader.js","api/TDX/Bus/EstimatedTimeOfArrival.js","api/TDX/city_data.js","api/TDX/Bus/BusStop.js","assets/icons/pin.svg","assets/icons/directions_bus_filled_24dp.svg","assets/icons/radio_button_checked_black_24dp.svg","components/Map/BusRouteMap.jsx","assets/icons/map.svg","components/EstimationOfArrivalTime/BusEstimatedTimeList.jsx","assets/icons/favorite_24dp.svg","assets/icons/favorite_border_24dp.svg","components/LocalStorage/LikedBusRoute.jsx","assets/icons/west_24dp.svg","components/Utils/BackPage.jsx","pages/BusEstimatedTime.jsx","constants/Trie.js","api/TDX/Bus/BusRoute.js","components/Search/BusRouteSearchList.jsx","assets/icons/search_black_24dp.svg","pages/FindBusRoute.jsx","api/TDX/Bus/BusStation.js","components/Search/BusStationSearchList.jsx","pages/FindBusStation.jsx","assets/icons/bus_c1.svg","assets/icons/bus_c2.svg","assets/icons/bus_c4.svg","assets/icons/bus_c3.svg","assets/icons/bus_c5.svg","components/Banner/Banner.jsx","components/Map/NearByBusStationMap.jsx","router/index.js","pages/Home.jsx","pages/NearByBusStation.jsx","pages/LikedList.jsx","components/LocalStorage/util.js","components/LocalStorage/StoreBusStation.jsx","components/Location/PosUserLocation.jsx","components/LocalStorage/StoreBusRoute.jsx","assets/icons/logo.svg","components/Header/Header.jsx","components/Footer/Footer.jsx","App.js","reportWebVitals.js","components/ScrollToTop.jsx","index.js"],"names":["getAuthorizationHeader","GMTString","Date","toGMTString","ShaObj","jsSHA","setHMACKey","process","update","Authorization","getHMAC","getStopOfRoute","city","routeUID","a","axios","method","url","headers","then","response","data","catch","error","console","log","route_data","length","forEach","stop","StopSequence","find","route_dir_stop","Direction","Stops","route_stop","StopUID","ind","res","item","push","sort","b","city_data","Taipei","NewTaipei","Kaohsiung","Hsinchu","HsinchuCounty","MiaoliCounty","ChanghuaCounty","NantouCounty","YunlinCounty","ChiayiCounty","Chiayi","PingtungCounty","YilanCounty","HualienCounty","TaitungCounty","PenghuCounty","Tainan","KinmenCounty","Taoyuan","Taichung","route_city_data","Keelung","LienchiangCounty","stop_city_data","RouteUID","pin_icon","Icon","iconUrl","pin","iconSize","className","point_icon","point","PinStop","stopsOfRoute","direction","mapStop","map","arr","Marker","position","StopPosition","PositionLat","PositionLon","icon","Popup","StopName","Zh_tw","BusRouteMap","userLocation","useContext","UserLocationContext","BusStationContext","useState","setMap","useEffect","pos","target_stop","setView","MapContainer","center","zoom","scrollWheelZoom","whenCreated","TileLayer","attribution","latitude","longitude","StopStatus","getEstimatedTimeStr","EstimateTime","minutes","Math","ceil","NextBusTime","time","h","getHours","m","getMinutes","slice","EstimatedTimeItem","pinStop","setMapStop","coming_status","getComingStatus","isNear","setIsNear","child","document","getElementById","parent","scrollTop","offsetTop","clientHeight","id","onClick","style","cursor","getDistance","x","y","pow","BusEstimatedTimeList","estimateData","RouteData","setDirection","setPinStop","setStopsOfRoute","hideMap","setHideMap","getStopsOfRoute","City","distance","nearest_stop","d","src","alt","DestinationStopNameZh","DepartureStopNameZh","height","LikedBusRoute","isLike","setIsLike","liked_bus_route_list","JSON","parse","localStorage","getItem","setItem","stringify","uid","favorite_24dp","favorite_border_24dp","e","preventDefault","index","findIndex","splice","clickHandle","BackPage","content","history","useHistory","goBack","west_24dp","BusEstimatedTimeRouteName","RouteName","TrieNode","this","indices","children","cur","Object","entries","values","node","getAllIndices","Trie","root","word","i","prefix","getBusCityRoute","promise_arr","keys","data_arr","Promise","all","items","BusRouteSearchList","route_list","busRoute","inputContent","setCity","onChange","target","value","filter","to","FindBusRouteInput","inputHandle","search_black_24dp","inputMode","placeholder","autoComplete","getBusCityStation","datas","StationEnName","En","StationUID","StationName","StationPosition","StationAddress","binarySearchLon","bus_station","goal_lon","left","right","mid","floor","station","getNearByBusStation","radius","adjusted_radius","right_index","left_index","BusStationSearchList","station_list","busStation","BusRouteContext","prepare","setPrepare","p","route","FindBusStationInput","Banner","bus_icon","bus","PinNearByBusStationPosition","nearByBusStation","NearByBusStationMap","setNearByBusStation","routes","path","exact","component","bus_c1","bus_c5","bus_c2","bus_c4","setInputContent","routeList","setRouteList","busRouteTrie","setBusRouteTrie","bus_route","t","insert","first_digit_ind","route_name","findFirstDigit","getBusRouteTrie","findAllIndices","item_ind","route1","route2","useParams","busEstimatedData","setBusEstimatedData","updateTime","setUpdateTime","tick","useCallback","periodic_action","setInterval","clearInterval","getBusRouteEstimatedArrival","stationList","setStationList","busStationTrie","setBusStationTrie","getBusStationTrie","station1","station2","pick","likedRouteList","getExpireTime","milliseconds","expire_time","shift","getTime","setTime","toUTCString","messages","StoreBusStation","setBusStation","loading","setLoading","saved_bus_station","LZString","decompressFromBase64","getAllBusCityStation","compressToBase64","message","getLocation","setUserLocation","prevLocation","setPrevLocation","navigator","geolocation","getCurrentPosition","currentLocation","needUpdate","coords","msg","code","dd","PosUserLocation","period","StoreBusRoute","setBusRoute","saved_bus_route","getAllBusCityRoute","Header","isOpen","setOpen","logo","size","toggled","toggle","HamburgerMenu","Footer","createContext","App","Provider","renderRoutes","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","withRouter","unlisten","listen","window","scrollTo","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.a492c7bb.chunk.js","sourcesContent":["import jsSHA from 'jssha';\n\nfunction getAuthorizationHeader() {\n    const AppID = process.env.REACT_APP_API_ID || 'FFFFFFFF-FFFF-FFFF-FFFF-FFFFFFFFFFFF';\n    const AppKey = process.env.REACT_APP_API_KEY || 'FFFFFFFF-FFFF-FFFF-FFFF-FFFFFFFFFFFF';\n    \n    const GMTString = new Date().toGMTString();\n    const ShaObj = new jsSHA('SHA-1', 'TEXT');\n    ShaObj.setHMACKey(AppKey, 'TEXT');\n    ShaObj.update('x-date: ' + GMTString);\n    const HMAC = ShaObj.getHMAC('B64');\n    const Authorization = 'hmac username=\"' + AppID + '\", algorithm=\"hmac-sha1\", headers=\"x-date\", signature=\"' + HMAC + '\"';\n\n    return {\n        Authorization: Authorization,\n        'X-Date': GMTString\n    };\n}\n\nexport default getAuthorizationHeader;","import axios from \"axios\";\nimport {\n    DEBUG\n} from \"../../../constants/debug\";\nimport getAuthorizationHeader from \"../getAuthorizationHeader\";\n\n\nasync function getStopOfRoute(city, routeUID) {\n    return axios({\n            method: 'get',\n            url: `https://ptx.transportdata.tw/MOTC/v2/Bus/DisplayStopOfRoute/City/${city}?$select=Direction%2CStops&$filter=RouteUID%20eq%20'${routeUID}'&$format=JSON`,\n            headers: getAuthorizationHeader()\n        })\n        .then((response) => {\n            DEBUG && console.log(`${routeUID} StopOfRoute`, response);\n            return response.data;\n        })\n        .catch((error) => console.log(`error: StopOfRoute `, error))\n}\n\n\n// {\n//     \"StopUID\": \"TPE34747\",\n//     \"StopName\": {\n//         \"Zh_tw\": \"龍山寺(康定)\",\n//         \"En\": \"Longshan Temple(Kangding)\"\n//     },\n//     \"RouteUID\": \"TPE10181\",\n//     \"RouteName\": {\n//         \"Zh_tw\": \"205\",\n//         \"En\": \"205\"\n//     },\n//     \"Direction\": 1,\n//     \"EstimateTime\": 74,\n//     \"StopStatus\": 0,\n//     \"SrcUpdateTime\": \"2021-11-24T18:44:20+08:00\",\n//     \"UpdateTime\": \"2021-11-24T18:44:24+08:00\"\n// }, {\n//     \"StopUID\": \"TPE34746\",\n//     \"StopName\": {\n//         \"Zh_tw\": \"萬華車站\",\n//         \"En\": \"Wanhua Station\"\n//     },\n//     \"RouteUID\": \"TPE10181\",\n//     \"RouteName\": {\n//         \"Zh_tw\": \"205\",\n//         \"En\": \"205\"\n//     },\n//     \"Direction\": 1,\n//     \"EstimateTime\": 1991,\n//     \"StopStatus\": 0,\n//     \"SrcUpdateTime\": \"2021-11-24T18:44:20+08:00\",\n//     \"UpdateTime\": \"2021-11-24T18:44:24+08:00\"\n// },\n\nexport async function getBusRouteEstimatedArrival(city, routeUID) {\n    return axios({\n            method: 'get',\n            url: `https://ptx.transportdata.tw/MOTC/v2/Bus/EstimatedTimeOfArrival/City/${city}?$select=PlateNumb%2CStopUID%2CStopName%2CRouteUID%2CRouteName%2CSubRouteUID%2CSubRouteName%2CDirection%2CEstimateTime%2CCurrentStop%2CDestinationStop%2CStopSequence%2CStopStatus%2CNextBusTime%2CIsLastBus%2CSrcUpdateTime&$filter=RouteUID%20eq%20'${routeUID}'&$orderby=StopSequence&$format=JSON`,\n            headers: getAuthorizationHeader()\n        })\n        .then(async (response) => {\n            DEBUG && console.log(`${routeUID} 時間資料`, response);\n            let data = response.data;\n            return getStopOfRoute(city, routeUID)\n                .then(route_data => {\n                    if (route_data && route_data.length > 0) {\n                        data.forEach(stop => {\n                            stop.StopSequence = route_data.find(route_dir_stop =>\n                                stop.Direction === route_dir_stop.Direction\n                            ).Stops.find(route_stop => route_stop.StopUID === stop.StopUID).StopSequence;\n                        });\n                    } else {\n                        data.forEach((stop, ind) => {\n                            stop.StopSequence = ind;\n                        });\n                    }\n                })\n                .then(() => {\n                    let res = {\n                        0: [],\n                        1: [],\n                        2: [],\n                        255: []\n                    };\n                    data.forEach(item => {\n                        res[item.Direction].push(item);\n                    });\n                    for (let item in res) {\n                        res[item] = res[item].sort((a, b) =>\n                            +a.StopSequence < +b.StopSequence ? -1 : 1\n                        );\n                    }\n                    return res;\n                })\n        })\n        .catch((error) => console.log(`error: estimated arrival `, error))\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// PlateNumb,StopUID,StopName,RouteUID,RouteName,SubRouteUID,SubRouteName,Direction,EstimateTime,CurrentStop,DestinationStop,StopSequence,StopStatus,NextBusTime,IsLastBus,SrcUpdateTime","export const city_data = {\n    Taipei: \"臺北市\",\n    NewTaipei: \"新北市\",\n    Kaohsiung: \"高雄市\",\n    Hsinchu: \"新竹市\",\n    HsinchuCounty: \"新竹縣\",\n    MiaoliCounty: \"苗栗縣\",\n    ChanghuaCounty: \"彰化縣\",\n    NantouCounty: \"南投縣\",\n    YunlinCounty: \"雲林縣\",\n    ChiayiCounty: \"嘉義縣\",\n    Chiayi: \"嘉義市\",\n    PingtungCounty: \"屏東縣\",\n    YilanCounty: \"宜蘭縣\",\n    HualienCounty: \"花蓮縣\",\n    TaitungCounty: \"臺東縣\",\n    PenghuCounty: \"澎湖縣\",\n    Tainan: \"臺南市\",\n    KinmenCounty: \"金門縣\",\n    Taoyuan: \"桃園市\",\n    Taichung: \"臺中市\"\n}\nexport const route_city_data = {\n    Taipei: \"臺北市\",\n    NewTaipei: \"新北市\",\n    Taoyuan: \"桃園市\",\n    Taichung: \"臺中市\",\n    Tainan: \"臺南市\",\n    Kaohsiung: \"高雄市\",\n    Keelung: \"基隆市\",\n    Hsinchu: \"新竹市\",\n    HsinchuCounty: \"新竹縣\",\n    MiaoliCounty: \"苗栗縣\",\n    ChanghuaCounty: \"彰化縣\",\n    NantouCounty: \"南投縣\",\n    YunlinCounty: \"雲林縣\",\n    ChiayiCounty: \"嘉義縣\",\n    Chiayi: \"嘉義市\",\n    PingtungCounty: \"屏東縣\",\n    YilanCounty: \"宜蘭縣\",\n    HualienCounty: \"花蓮縣\",\n    TaitungCounty: \"臺東縣\",\n    KinmenCounty: \"金門縣\",\n    PenghuCounty: \"澎湖縣\",\n    LienchiangCounty: \"連江縣\",\n};\n\nexport const stop_city_data = {\n    NewTaipei: \"新北市\",\n    Taoyuan: \"桃園市\",\n    Taichung: \"臺中市\",\n    Tainan: \"臺南市\",\n    Kaohsiung: \"高雄市\",\n    Keelung: \"基隆市\",\n    Hsinchu: \"新竹市\",\n    HsinchuCounty: \"新竹縣\",\n    MiaoliCounty: \"苗栗縣\",\n    ChanghuaCounty: \"彰化縣\",\n    NantouCounty: \"南投縣\",\n    YunlinCounty: \"雲林縣\",\n    ChiayiCounty: \"嘉義縣\",\n    Chiayi: \"嘉義市\",\n    PingtungCounty: \"屏東縣\",\n    YilanCounty: \"宜蘭縣\",\n    HualienCounty: \"花蓮縣\",\n    TaitungCounty: \"臺東縣\",\n    KinmenCounty: \"金門縣\",\n    PenghuCounty: \"澎湖縣\",\n    LienchiangCounty: \"連江縣\",\n    Taipei: \"臺北市\",\n}","import axios from \"axios\";\nimport {\n    stop_city_data\n} from \"../city_data\";\nimport getAuthorizationHeader from \"../getAuthorizationHeader\";\n\nexport async function getStopsOfRoute(city, RouteUID) {\n    return axios({\n            method: 'get',\n            url: `https://ptx.transportdata.tw/MOTC/v2/Bus/StopOfRoute/City/${city}?$filter=RouteUID%20eq%20'${RouteUID}'&$format=JSON`,\n            headers: getAuthorizationHeader()\n        })\n        .then((response) => {\n            return response.data;\n        }).then((data) => {\n            let res = {\n                0: [],\n                1: [],\n                2: [],\n                255: []\n            };\n            data.forEach(item => {\n                res[item.Direction].push(item);\n            });\n            for (let item in res) {\n                res[item] = res[item].sort((a, b) =>\n                    +a.StopSequence < +b.StopSequence ? -1 : 1\n                );\n            }\n            return res;\n        })\n        .catch((error) => console.log(`error: ${stop_city_data[city]}公車站牌資料 `, error))\n\n}","export default __webpack_public_path__ + \"static/media/pin.9bb06f23.svg\";","export default __webpack_public_path__ + \"static/media/directions_bus_filled_24dp.1adceefa.svg\";","export default __webpack_public_path__ + \"static/media/radio_button_checked_black_24dp.9a33b9ed.svg\";","import { useContext, useEffect, useState } from 'react';\nimport { MapContainer, Marker, Popup, TileLayer } from 'react-leaflet'\nimport { BusStationContext, UserLocationContext } from '../../App';\nimport pin from '../../assets/icons/pin.svg';\nimport bus from '../../assets/icons/directions_bus_filled_24dp.svg';\nimport point from '../../assets/icons/radio_button_checked_black_24dp.svg';\nimport { Icon, Polyline } from 'leaflet';\n\nconst pin_icon = new Icon({\n    iconUrl: pin,\n    iconSize: [24, 24],\n    className: 'leaflet-marker-icon pin-icon red'\n});\n\nconst point_icon = new Icon({\n    iconUrl: point,\n    iconSize: [36, 36],\n    className: 'leaflet-marker-icon'\n})\n\n\nfunction PinStop({ stopsOfRoute, direction, mapStop = \"\" }) {\n    if (stopsOfRoute[direction] && stopsOfRoute[direction][0]) {\n        return (\n            stopsOfRoute[direction][0].Stops.map((data, ind, arr) =>\n                <div key={data.StopUID}>\n                    <Marker position={[data.StopPosition.PositionLat, data.StopPosition.PositionLon]} icon={point_icon}>\n                        <Popup >\n                            <span>{data.StopName.Zh_tw}</span>\n                        </Popup>\n                    </Marker>\n                </div>\n            )\n        );\n    } else {\n        return null;\n    }\n}\n\nexport default function BusRouteMap({ stopsOfRoute, direction, mapStop }) {\n    const userLocation = useContext(UserLocationContext);\n    const busStation = useContext(BusStationContext);\n    const [map, setMap] = useState(null);\n\n    useEffect(() => {\n        if (map) {\n            if (stopsOfRoute[direction] && stopsOfRoute[direction][0] && stopsOfRoute[direction][0].Stops.length) {\n                // const pos = stopsOfRoute[direction][0].Stops[Math.floor(stopsOfRoute[direction][0].Stops.length / 2)].StopPosition;\n                let pos = stopsOfRoute[direction][0].Stops[0].StopPosition;\n                if (mapStop && mapStop[direction]) {\n                    const target_stop = stopsOfRoute[direction][0].Stops.find(stop => stop.StopUID === mapStop);\n                    if (target_stop) {\n                        pos = target_stop.StopPosition;\n                    }\n                }\n                map.setView([pos.PositionLat, pos.PositionLon]);\n            }\n        }\n    }, [map, stopsOfRoute, direction, mapStop]);\n\n\n    return (\n        <MapContainer center={[22.9977325, 120.2141299]} zoom={16} scrollWheelZoom={false} whenCreated={setMap}>\n            <TileLayer\n                attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n                url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n            />\n            <Marker position={[userLocation.latitude, userLocation.longitude]} icon={pin_icon}>\n                <Popup>\n                    <div className=\"pin-here\">你在這裡</div>\n                </Popup>\n            </Marker>\n            <PinStop mapStop={mapStop} stopsOfRoute={stopsOfRoute} direction={direction} />\n        </MapContainer>\n    )\n}\n\n\n\n// const map_icon = new Icon({\n//     iconUrl: map,\n//     iconSize: [32, 32],\n//     className: 'leaflet-marker-icon route'\n// })\n\n\n// function getCorners(geometry) {\n//     let top = geometry[0][0], left = geometry[0][1];\n//     let bottom = top, right = left;\n//     for (let geo of geometry) {\n//         if (geo[0] > top) {\n//             top = geo[0];\n//         } else if (geo[0] < bottom) {\n//             bottom = geo[0];\n//         }\n//         if (geo[1] < left) {\n//             left = geo[1];\n//         } else if (geo[1] > right) {\n//             right = geo[1];\n//         }\n//     }\n//     return [[bottom, left], [top, right]];\n// }\n\n// function getCenter(corners) {\n//     return [(corners[0][0] + corners[1][0]) / 2, (corners[0][1] + corners[1][1]) / 2];\n// }\n\n// function getDiameter(corners) {\n//     return Math.pow(Math.pow(corners[0][0] - corners[0][1], 2) + Math.pow(corners[1][0] - corners[1][1], 2), 0.5)\n// }\n\n// const routeOptions = { color: '#51AB5B' }\n\n// export default function RouteMap({ geometry, distance, seeToggle = true }) {\n//     const userLocation = useContext(UserLocation);\n//     const [map, setMap] = useState(null);\n//     const [mode, setMode] = useState(\"borrow\");\n\n//     // api is latitude first then longitude\n//     geometry = geometry.map(item => [item[1], item[0]]);\n//     let geometry_group = [];\n//     let prev＿start = 0;\n//     for (let i = 1; i < geometry.length; ++i) {\n//         if (!geometry[i][0] || !geometry[i][1]) {\n//             geometry_group.push(geometry.slice(prev＿start, i));\n//             ++i;\n//             prev＿start = i + 1;\n//         }\n//     }\n//     geometry_group.push(geometry.slice(prev＿start, geometry.length));\n\n\n\n//     const corners = getCorners(geometry);\n//     // center is center of geometry center and start position\n//     const center = getCenter([getCenter(corners), geometry[0]]);\n//     // const diameter = getDiameter(corners);\n//     const zoom = (\n//         distance <= 500 ? 16 :\n//             distance <= 3000 ? 15 :\n//                 14\n//     )\n//     useEffect(() => {\n//         if (map) {\n//             map.setView(center, zoom);\n//         }\n//     }, [map, center]);\n\n\n//     function handleClick() {\n//         if (mode === 'borrow') {\n//             setMode('return');\n//         } else {\n//             setMode('borrow');\n//         }\n//     }\n\n//     return (\n//         <>\n//             {seeToggle && <BorrowReturnToggle isToggleOn={mode === 'return'} handleClick={handleClick} />}\n//             <MapContainer center={[25.0210905, 121.5353809]} zoom={15} scrollWheelZoom={false} whenCreated={setMap}>\n//                 <TileLayer\n//                     attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n//                     url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n//                 />\n//                 {geometry_group.map((item, ind) => {\n//                     return (\n//                         <Polyline key={ind} pathOptions={routeOptions} positions={item} />\n//                     )\n//                 })}\n//                 {seeToggle && <BikePosition mode={mode} location={geometry[0]} />}\n//                 <Marker position={geometry[0]} icon={map_icon}>\n//                     <Popup>\n//                         起點\n//                     </Popup>\n//                 </Marker>\n//             </MapContainer>\n//         </>\n//     );\n// }","export default __webpack_public_path__ + \"static/media/map.b03c20b2.svg\";","import { useContext, useEffect, useState } from \"react\";\nimport { getStopsOfRoute } from \"../../api/TDX/Bus/BusStop\";\nimport { UserLocationContext } from \"../../App\";\nimport BusRouteMap from \"../Map/BusRouteMap\";\nimport map from '../../assets/icons/map.svg';\n\nconst StopStatus = {\n    0: '正常',\n    1: '未發車',\n    2: '不停靠',\n    3: '末班已過',\n    4: '今未營運'\n}\n\nfunction getEstimatedTimeStr(data) {\n    if (data.StopStatus > 1) {\n        return StopStatus[data.StopStatus];\n    } else if (data.StopStatus === 0 || data.EstimateTime) {\n        const minutes = Math.ceil(data.EstimateTime / 60);\n        if (minutes > 2) {\n            return minutes + ' 分';\n        } else if (minutes === 2) {\n            return \"即將進站\";\n        } else {\n            return \"進站中\";\n        }\n    } else if (data.NextBusTime) {\n        const time = new Date(data.NextBusTime);\n        const h = '0' + time.getHours();\n        const m = '0' + time.getMinutes();\n        return h.slice(h.length - 2) + ':' + m.slice(m.length - 2);\n    } else {\n        return StopStatus[1];\n    }\n}\n\n\nfunction getComingStatus(data) {\n    // 0 normal, 1 coming, 2 gray \n    if (data.StopStatus > 1) {\n        return 2;\n    } else if (data.StopStatus === 0 || data.EstimateTime) {\n        const minutes = Math.ceil(data.EstimateTime / 60);\n        if (minutes <= 2) {\n            return 1;\n        } else {\n            return 0;\n        }\n    } else {\n        return 2;\n    }\n}\n\nfunction EstimatedTimeItem({ data, pinStop, direction, setMapStop }) {\n    const coming_status = getComingStatus(data);\n    const [isNear, setIsNear] = useState(false);\n    useEffect(() => {\n        let child = document.getElementById(data.StopUID);\n        let parent = document.getElementById('timeList');\n        if (pinStop[direction] === data.StopUID) {\n            if (child) {\n                parent.scrollTop = child.offsetTop - child.clientHeight * 2;\n                setIsNear(true);\n            }\n        } else {\n            setIsNear(false);\n        }\n    }, [pinStop, direction]);\n    return (\n        <div id={data.StopUID} onClick={() => { setMapStop(data.StopUID) }} className={\"flex items-center arrival-time-item \" + (isNear ? \"bg-blue-300 \" : \"\") + (coming_status === 1 && \"bg-gray-100\")} style={{ cursor: \"pointer\" }}>\n            <div className={\"flex justify-center items-center arrival-time-estimated-time \" + (coming_status === 1 ? \"comming\" : coming_status === 2 ? \"gray\" : \"\")}>\n                <div>{getEstimatedTimeStr(data)}</div>\n            </div>\n            <div className=\" ml-8 arrival-time-stop-name flex justify-between\">\n                {data.StopName.Zh_tw}\n            </div>\n        </div>\n    )\n}\n\n\n// unit: meter\nfunction getDistance(stop, center) {\n    const x = (stop.StopPosition.PositionLon - center.longitude) * 100000;\n    const y = (stop.StopPosition.PositionLat - center.latitude) * 100000;\n    return Math.pow(Math.pow(x, 2) + Math.pow(y, 2), 0.5);\n}\n\nexport default function BusEstimatedTimeList({ estimateData, RouteData }) {\n    const [direction, setDirection] = useState(0);\n    const [pinStop, setPinStop] = useState({});\n    const [mapStop, setMapStop] = useState(\"\");\n    const userLocation = useContext(UserLocationContext);\n    const [stopsOfRoute, setStopsOfRoute] = useState([]);\n    const [hideMap, setHideMap] = useState(true);\n\n    useEffect(() => {\n        if (RouteData) {\n            getStopsOfRoute(RouteData.City, RouteData.RouteUID).then(res => setStopsOfRoute(res));\n        }\n    }, [RouteData])\n\n    useEffect(() => {\n        const distance_bound = 500;\n        let res = {};\n        let distance = 10000;\n        let nearest_stop = \"\";\n\n        stopsOfRoute[0] && stopsOfRoute[0][0] && stopsOfRoute[0][0].Stops.forEach(stop => {\n            const d = getDistance(stop, userLocation);\n            if (d < distance && d < distance_bound) {\n                distance = d;\n                nearest_stop = stop.StopUID;\n            }\n        });\n        res[0] = nearest_stop;\n\n        distance = 10000;\n        nearest_stop = \"\";\n        stopsOfRoute[1] && stopsOfRoute[1][0] && stopsOfRoute[1][0].Stops.forEach(stop => {\n            const d = getDistance(stop, userLocation);\n            if (d < distance && d < distance_bound) {\n                distance = d;\n                nearest_stop = stop.StopUID;\n            }\n        });\n        res[1] = nearest_stop;\n\n        distance = 10000;\n        nearest_stop = \"\";\n        stopsOfRoute[2] && stopsOfRoute[2][0] && stopsOfRoute[2][0].Stops.forEach(stop => {\n            const d = getDistance(stop, userLocation);\n            if (d < distance && d < distance_bound) {\n                distance = d;\n                nearest_stop = stop.StopUID;\n            }\n        });\n        res[2] = nearest_stop;\n\n        setPinStop(res);\n    }\n        , [stopsOfRoute, userLocation]);\n\n\n    return (\n        <div className=\"arrival-time-block h-full flex flex-col\">\n            <div className=\"flex justify-between\">\n                <span></span>\n                <div className=\"flex justify-center items-center tracking-widest mr-1 cursor-pointer py-1\" onClick={() => setHideMap(!hideMap)}>\n                    <img src={map} className=\"h-4 mr-2\" alt=\"地圖圖案\"></img>\n                    {hideMap ? \"打開地圖\" : \"收起地圖\"}\n                </div>\n            </div>\n            <div className={\"grow-0 transition-all \" + (hideMap ? 'h-0' : 'h-60 lg:h-80')}>\n                <div className={`w-full  h-60 lg:h-80`}>\n                    {pinStop && stopsOfRoute && <BusRouteMap stopsOfRoute={stopsOfRoute} mapStop={mapStop} direction={direction} data={estimateData} />}\n                </div>\n            </div>\n            <div className=\"z-10 bg-white\">\n                <div className=\"flex items-center \">\n                    {0 in estimateData && estimateData[0].length > 0 &&\n                        <div className={`flex-1 flex items-center justify-center arrival-time-direction-toggle ` + (direction === 0 ? 'on' : null)} onClick={() => setDirection(0)}>\n                            往&nbsp;<span className=\"font-bold\">{RouteData.DestinationStopNameZh}</span>\n                        </div>\n                    }\n                    {1 in estimateData && estimateData[1].length > 0 &&\n                        <div className={`flex-1 flex items-center justify-center arrival-time-direction-toggle ` + (direction === 1 ? 'on' : null)} onClick={() => setDirection(1)}>\n                            往&nbsp;<span className=\"font-bold\">{RouteData.DepartureStopNameZh}</span>\n                        </div>\n                    }\n                    {2 in estimateData && estimateData[2].length > 0 &&\n                        <div className={`flex-1 flex items-center justify-center arrival-time-direction-toggle ` + (direction === 2 ? 'on' : null)} onClick={() => setDirection(2)}>\n                            <span className=\"font-bold\">迴圈</span>\n                        </div>\n                    }\n                </div>\n                <div id=\"timeList\" className=\"max-h-screen bg-white shadow-lg   px-4  overflow-auto relative\" style={{ height: (hideMap ? \"75vh\" : \"30vh\") }}>\n                    {\n                        direction in estimateData &&\n                        estimateData[direction].map(item => {\n                            return <EstimatedTimeItem key={item.StopSequence} setMapStop={setMapStop} data={item} pinStop={pinStop} direction={direction} />\n                        })\n                    }\n                </div>\n            </div>\n        </div>\n    )\n}","export default __webpack_public_path__ + \"static/media/favorite_24dp.53c45348.svg\";","export default __webpack_public_path__ + \"static/media/favorite_border_24dp.e0f3e7ea.svg\";","import { useEffect, useState } from 'react';\nimport favorite_24dp from '../../assets/icons/favorite_24dp.svg'\nimport favorite_border_24dp from '../../assets/icons/favorite_border_24dp.svg'\n\nexport default function LikedBusRoute({ RouteUID, className }) {\n    const [isLike, setIsLike] = useState(false);\n    // check if it is liked or not\n    useEffect(() => {\n        let liked_bus_route_list = JSON.parse(localStorage.getItem(\"liked_bus_route_list\"));\n        if (!liked_bus_route_list) {\n            localStorage.setItem(\"liked_bus_route_list\", JSON.stringify([]));\n            liked_bus_route_list = JSON.parse(localStorage.getItem(\"liked_bus_route_list\"));\n        }\n        setIsLike(liked_bus_route_list.find(uid => uid === RouteUID) ? true : false);\n    }, [RouteUID]);\n    // toggle handle\n    function clickHandle() {\n        if (isLike) {\n            let liked_bus_route_list = JSON.parse(localStorage.getItem(\"liked_bus_route_list\"));\n            const index = liked_bus_route_list.findIndex(uid => uid === RouteUID);\n            if (index !== -1) {\n                liked_bus_route_list.splice(index, 1);\n                localStorage.setItem(\"liked_bus_route_list\", JSON.stringify(liked_bus_route_list));\n            }\n            setIsLike(false);\n        } else {\n            let liked_bus_route_list = JSON.parse(localStorage.getItem(\"liked_bus_route_list\"));\n            const index = liked_bus_route_list.findIndex(uid => uid === RouteUID);\n            if (index === -1) {\n                liked_bus_route_list.push(RouteUID);\n                localStorage.setItem(\"liked_bus_route_list\", JSON.stringify(liked_bus_route_list));\n            }\n            setIsLike(true);\n        }\n    }\n    return <img className={className+ \" p-3 \"} src={isLike ? favorite_24dp : favorite_border_24dp} alt={isLike ? \"已收藏 liked\" : \"收藏他 like\"} onClick={\n        (e) =>{\n        e.preventDefault();\n        clickHandle();\n    } } />;\n}","export default __webpack_public_path__ + \"static/media/west_24dp.77f97c6f.svg\";","import { useHistory } from \"react-router\";\nimport west_24dp from '../../assets/icons/west_24dp.svg';\n\nexport default function BackPage({ content = \"返回上頁\" }) {\n    let history = useHistory();\n    return (\n        <div className=\"bg-white view-border pt-4 flex pl-1\" >\n            <div className=\"flex\" onClick={() => history.goBack()} style={{ cursor: \"pointer\" }}>\n                <img src={west_24dp} alt='回上一頁 back to previous page' />\n                <span className=\"ml-2\">{content}</span>\n            </div>\n        </div>\n    )\n}","import { useCallback, useContext, useEffect, useState } from \"react\";\nimport { useParams } from \"react-router\";\nimport { getBusRouteEstimatedArrival } from \"../api/TDX/Bus/EstimatedTimeOfArrival\";\nimport { BusRouteContext } from \"../App\";\nimport BusEstimatedTimeList from \"../components/EstimationOfArrivalTime/BusEstimatedTimeList\";\nimport { DEBUG } from \"../constants/debug\";\n\n\nimport LikedBusRoute from \"../components/LocalStorage/LikedBusRoute\";\nimport BackPage from \"../components/Utils/BackPage\";\n\n\n\nfunction BusEstimatedTimeRouteName({ RouteData }) {\n\n    return (\n        <>\n            <div className=\"bg-white flex justify-center items-center h-16 px-4\">\n                <span className=\"ml-10\">&nbsp;</span>\n                <div className=\"bus-estimated-time-routename\">\n                    {RouteData.RouteName.Zh_tw}\n                </div>\n                <div>\n                    <LikedBusRoute RouteUID={RouteData.RouteUID} />\n                </div>\n            </div>\n        </>\n    );\n}\n\n\nexport default function BusEstimatedTime() {\n    const busRoute = useContext(BusRouteContext);\n    const RouteUID = useParams()['RouteUID'];\n    const RouteData = busRoute.find(route => route.RouteUID === RouteUID);\n    const [busEstimatedData, setBusEstimatedData] = useState([]);\n    const [updateTime, setUpdateTime] = useState(0);\n\n    // tick\n    const tick = useCallback(() => {\n        if (updateTime > 0) {\n            setUpdateTime(updateTime - 1);\n        }\n    }, [updateTime]);\n\n    useEffect(() => {\n        let periodic_action = setInterval(tick, 1000);\n        return () => {\n            clearInterval(periodic_action);\n        }\n    }, [tick]);\n\n    // Update bus estimated arrival time data\n    useEffect(() => {\n        if (updateTime === 0 && RouteData) {\n            DEBUG && console.log('fetch bus estimated arrival time data');\n            getBusRouteEstimatedArrival(RouteData.City, RouteData.RouteUID)\n                .then(res => {\n                    setBusEstimatedData(res);\n                })\n                .then(\n                    () => setUpdateTime(10)\n                )\n                .then(() => {\n                    DEBUG && console.log('Bus estimated arrival time data', busEstimatedData);\n                })\n        }\n    }, [updateTime, RouteData, busEstimatedData]);\n\n    return (\n        <div className=\"h-full flex flex-col\">\n            <BackPage />\n            {RouteData && <BusEstimatedTimeRouteName RouteData={RouteData} />}\n            <div className=\"bg-white tracking-widest sticky top-0 z-10\">\n                <div className=\" text-right lg:text-center py-1\">{updateTime}秒後更新</div>\n            </div>\n            <div className=\"view-border lg:pb-10 h-full flex flex-col\">\n                {busEstimatedData ? <BusEstimatedTimeList estimateData={busEstimatedData} RouteData={RouteData} /> : <div className=\"flex justify-center items-center my-10\"><p >出問題了！請回到上一頁重整並再試一次。</p></div>}\n            </div>\n        </div>\n    );\n}","class TrieNode {\n    constructor() {\n        this.indices = [];\n        this.children = {};\n    }\n    getAllIndices() {\n        let cur = this;\n        let res = [...cur.indices];\n        if (Object.entries(cur.children).length > 0) {\n            Object.values(cur.children).forEach(node => {\n                res.push(...node.getAllIndices());\n            })\n        }\n        return res;\n    }\n}\n\nexport class Trie {\n    constructor() {\n        this.root = new TrieNode();\n    }\n    insert(word, ind) {\n        let cur = this.root;\n        for (let i = 0; i < word.length; ++i) {\n            if (!cur.children[word[i]]) {\n                cur.children[word[i]] = new TrieNode();\n            }\n            cur = cur.children[word[i]];\n            if (i === word.length - 1) {\n                cur.indices.push(ind);\n            }\n        }\n    }\n    findAllIndices(prefix) {\n        let cur = this.root;\n        let res = [];\n        for (let i = 0; i < prefix.length; ++i) {\n            if (cur.children[prefix[i]]) {\n                cur = cur.children[prefix[i]];\n            } else {\n                return res;\n            }\n        }\n        return cur.getAllIndices();\n    }\n}","import axios from \"axios\";\nimport {\n    Trie\n} from \"../../../constants/Trie\";\nimport {\n    route_city_data\n} from \"../city_data\";\nimport getAuthorizationHeader from \"../getAuthorizationHeader\";\n\n\nconst DEBUG = process.env.REACT_APP_DEBUG === '1';\n\n\nconst BusRouteType = {\n    11: '市區公車',\n    12: '公路客運',\n    13: '國道客運',\n    14: '接駁車'\n};\n\n\nasync function getBusCityRoute(city) {\n    return axios({\n            method: 'get',\n            url: `https://ptx.transportdata.tw/MOTC/v2/Bus/Route/City/${city}?$format=JSON`,\n            headers: getAuthorizationHeader()\n        })\n        .then((response) => {\n            DEBUG && console.log(`${route_city_data[city]}公車路線資料`, response);\n            return response.data;\n        })\n        .catch((error) => console.log(`error: ${route_city_data[city]}公車路線資料 `, error))\n}\n\nexport async function getAllBusCityRoute() {\n    let promise_arr = [];\n    Object.keys(route_city_data).forEach(city => {\n        promise_arr.push(getBusCityRoute(city));\n    });\n    let data_arr = [];\n    return Promise.all(promise_arr)\n        .then(items => items.forEach(item => data_arr.push(...item)))\n        .then(() => data_arr)\n        .catch((e) => {\n            console.log('error: getAllBusCityRoute() ', e);\n        });\n}\n\nfunction findFirstDigit(route_name) {\n    for (let i = 0; i < route_name.length; ++i) {\n        if (route_name[i] >= '0' && route_name[i] <= '9') {\n            return i;\n        }\n    }\n    return -1;\n}\n\nexport function getBusRouteTrie(bus_route) {\n    let t = new Trie();\n    bus_route.forEach((route, ind) => {\n        route.RouteName.Zh_tw && t.insert(route.RouteName.Zh_tw, ind);\n        if (route.RouteName.En && route.RouteName.En !== route.RouteName.Zh_tw) {\n            t.insert(route.RouteName.En, ind)\n        }\n        const first_digit_ind = findFirstDigit(route.RouteName.Zh_tw);\n        if (first_digit_ind > 0) {\n            t.insert(route.RouteName.Zh_tw.slice(first_digit_ind), ind);\n        }\n    });\n    return t;\n}","import { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { route_city_data } from '../../api/TDX/city_data';\nimport LikedBusRoute from '../LocalStorage/LikedBusRoute';\nexport default function BusRouteSearchList({ route_list, busRoute, inputContent = \"\" }) {\n    const [city, setCity] = useState(\"\");\n    if (inputContent.length === 0 && city !== \"\") {\n        route_list = busRoute;\n    }\n    return (\n        <>\n            <div className=\"flex justify-between mx-4 my-1\">\n                <span></span>\n                <select className=\"bg-white\" onChange={(e) => setCity(e.target.value)}>\n                    <option value=\"\">全縣市</option>\n                    {Object.entries(route_city_data).map(city => (\n                        <option key={city[0]} value={city[0]}>{city[1]}</option>\n                    ))}\n                </select>\n            </div>\n            <div className=\"max-h-screen overflow-y-auto shadow-lg \" style={{ height: \"75vh\" }}>\n                {\n                    route_list.filter(data => {\n                        if (city === \"\" || data.City === city) {\n                            return data;\n                        } else {\n                            return false;\n                        }\n                    }).map((data, ind) => {\n                        return (\n                            <Link key={data.RouteUID} to={`/bus_estimated_time/${data.RouteUID}`}>\n                                <div className=\"route-search-item\">\n                                    <div>\n                                        <span className=\"route-name\">{data.RouteName.Zh_tw}</span>\n                                        <span className=\"route-city\">（{route_city_data[data.City]}）</span>\n                                        <br />\n                                        <span className=\"route-depart-dest\">{data.DepartureStopNameZh}-{data.DestinationStopNameZh}</span>\n                                    </div>\n                                    <LikedBusRoute RouteUID={data.RouteUID} />\n                                </div>\n                            </Link>\n                        )\n                    })\n                }\n            </div>\n        </>\n    );\n}","export default __webpack_public_path__ + \"static/media/search_black_24dp.b56cb96d.svg\";","import { useContext, useEffect, useState } from \"react\";\nimport { getBusRouteTrie } from \"../api/TDX/Bus/BusRoute\";\nimport { BusRouteContext } from \"../App\";\nimport BusRouteSearchList from \"../components/Search/BusRouteSearchList\";\nimport { Trie } from \"../constants/Trie\";\nimport search_black_24dp from '../assets/icons/search_black_24dp.svg';\nimport BackPage from \"../components/Utils/BackPage\";\n\n\nfunction FindBusRouteInput({ inputHandle }) {\n\n    return (\n        <div className=\"flex justify-center items-center\">\n            <div className=\"input-window flex justify-center items-center \">\n                <img src={search_black_24dp} className=\"lookup\" alt=\"尋找路線 serach icon\" />\n                <input className=\"input\" inputMode=\"numeric\" placeholder=\"請輸入公車路線或號碼\" autoComplete=\"off\" onChange={e => inputHandle(e.target.value)}></input>\n            </div>\n        </div>\n    );\n}\n\nexport default function FindBusRoute() {\n    const busRoute = useContext(BusRouteContext);\n    const [inputContent, setInputContent] = useState(\"\");\n    const [routeList, setRouteList] = useState([]);\n    const [busRouteTrie, setBusRouteTrie] = useState(new Trie());\n    function getInputContent(content) {\n        setInputContent(content);\n    }\n\n    //Build Trie for keyword selection\n    useEffect(() => {\n        if (busRoute) {\n            setBusRouteTrie(getBusRouteTrie(busRoute))\n        }\n    }, [busRoute]);\n\n    //Get candidates of route\n    useEffect(() => {\n        if (inputContent.length > 0) {\n            setRouteList(busRouteTrie.findAllIndices(inputContent).sort().filter(\n                (item, ind, arr) => ind === 0 || arr[ind - 1] !== arr[ind]).map(item_ind => busRoute[item_ind])\n                // sort for keyword selection\n                .sort((route1, route2) => {\n                    return (route1.RouteName.Zh_tw.length < route2.RouteName.Zh_tw.length ? -1 : 1)\n                })\n            );\n        } else {\n            setRouteList(busRoute.slice(0, 50));\n        }\n    }, [inputContent, busRouteTrie, busRoute]);\n\n    return (\n        <section className=\"bg-white pt-4 lg:pb-10  \">\n            <BackPage />\n            <div className=\"view-border\">\n                <FindBusRouteInput inputHandle={getInputContent} />\n                <BusRouteSearchList route_list={routeList} busRoute={busRoute} inputContent={inputContent} />\n            </div>\n        </section>\n    );\n\n}","import axios from \"axios\";\nimport {\n    Trie\n} from \"../../../constants/Trie\";\nimport {\n    city_data,\n    stop_city_data\n} from \"../city_data\";\nimport getAuthorizationHeader from \"../getAuthorizationHeader\";\n\n\nconst DEBUG = process.env.REACT_APP_DEBUG === '1';\n\n// Bus station data\n// {\n//     City,\n//     StationUID,\n//     StationName,\n//     StationEnName,\n//     StationPosition,\n//     StationAddress,\n//     Stops,\n// }\n\n// StationPosition: {\n//     PositionLat,\n//     PositionLon\n// }\n\n// Stops:[\n//     {\n//         StopUID\n//         RouteUID\n//     }\n// ]\n\nasync function getBusCityStation(city) {\n    return axios({\n            method: 'get',\n            url: `https://ptx.transportdata.tw/MOTC/v2/Bus/Station/City/${city}?$format=JSON`,\n            headers: getAuthorizationHeader()\n        })\n        .then((response) => {\n            DEBUG && console.log(`${city_data[city]}公車站位資料`, response);\n            let datas = response.data;\n            // Extract necessary attributes\n            datas = datas.map(data => {\n                data.StationEnName = data.Stops[0].StopName.En;\n                data.Stops = data.Stops.map(stop => {\n                    return {\n                        StopUID: stop.StopUID,\n                        RouteUID: stop.RouteUID,\n                        // RouteName: stop.RouteName.Zh_tw,\n                        // RouteEnName: stop.RouteName.En,\n                    }\n                })\n                return {\n                    City: city,\n                    StationUID: data.StationUID,\n                    StationName: data.StationName.Zh_tw,\n                    StationEnName: data.StationEnName,\n                    StationPosition: data.StationPosition,\n                    StationAddress: data.StationAddress,\n                    Stops: data.Stops\n                };\n            });\n            return datas;\n        })\n        .catch((error) => console.log(`error: ${city_data[city]}公車站位資料 `, error))\n}\n\nexport async function getAllBusCityStation() {\n    let promise_arr = [];\n    Object.keys(city_data).forEach(city => {\n        promise_arr.push(getBusCityStation(city));\n    });\n    let datas = [];\n    return Promise.all(promise_arr)\n        .then(items => items.forEach(item => datas.push(...item)))\n        // get city stop-to-station data which has no station data\n        // however it is a bit large\n        // .then(datas => {\n        //     let promise_arr = [];\n        //     Object.keys(stop_city_data).filter(city=>city_data[city]!==stop_city_data[city]).forEach(\n        //         city=>{\n        //             DEBUG && console.log('no station data city: ' ,city);\n        //             promise_arr.push(getBusCityStopToStation(city)); \n        //         }\n        //     ) \n        //     return Promise.all(promise_arr)\n        //         .then(items => items.forEach(item => datas.push(...item)))\n        //         .then(() => datas)\n        // })\n        .then(() => {\n            // For binary Search for position\n            datas=datas.sort(function (a, b) {\n                if (a.StationPosition.PositionLon < b.StationPosition.PositionLon) {\n                    return -1;\n                    // } else if (a.StationPosition.PositionLon === b.StationPosition.PositionLon) {\n                    //     return a.StationPosition.PositionLat < b.StationPosition.PositionLLat\n                } else {\n                    return 1;\n                }\n            });\n            return datas;\n        })\n        .catch((e) => {\n            console.log('error: getAllBusCityStation() ', e);\n        });\n}\n\nfunction binarySearchLon(bus_station, goal_lon, left, right) {\n    while (left < right) {\n        const mid = Math.floor(left + (right - left) / 2);\n        if (bus_station[mid].StationPosition.PositionLon < goal_lon) {\n            left = mid + 1;\n        } else {\n            right = mid;\n        }\n    }\n    return left;\n}\n\n// unit: meter\nfunction distance(station, center) {\n    const x = (station.StationPosition.PositionLon - center.longitude) * 100000;\n    const y = (station.StationPosition.PositionLat - center.latitude) * 100000;\n    return Math.pow(Math.pow(x, 2) + Math.pow(y, 2), 0.5);\n}\n// radius unit: meter\nexport function getNearByBusStation(bus_station, center, radius = 500) {\n    if (bus_station.length === 0) {\n        return [];\n    }\n    // 0.01 longitude or latitude is approximate 1 kilometer.\n    const adjusted_radius = radius / 100000;\n    const right_index = binarySearchLon(bus_station, center.longitude + adjusted_radius, 0, bus_station.length);\n    const left_index = binarySearchLon(bus_station, center.longitude - adjusted_radius, 0, right_index);\n    let res = [];\n    for (let i = left_index; i < right_index; ++i) {\n        if (distance(bus_station[i], center) < radius) {\n            res.push(bus_station[i]);\n        }\n    }\n    return res;\n\n}\n\nexport function getBusStationTrie(bus_station) {\n    let t = new Trie();\n    bus_station.forEach((station, ind) => {\n        station.StationName && t.insert(station.StationName, ind);\n        if (station.StationEnName && station.StationEnName !== station.StationName) {\n            t.insert(station.StationEnName, ind)\n        }\n    });\n    return t;\n}\n\n\nasync function getBusCityStopToStation(city) {\n    return axios({\n            method: 'get',\n            url: `https://ptx.transportdata.tw/MOTC/v2/Bus/Stop/City/${city}?$format=JSON`,\n            headers: getAuthorizationHeader()\n        })\n        .then((response) => {\n            return response.data;\n        })\n        .then(res => {\n            res = res.map(stop => {\n                return {\n                    City: stop.City,\n                    StationUID: stop.StopUID,\n                    StationName: stop.StopName.Zh_tw,\n                    StationEnName: stop.StopName.En,\n                    StationPosition: stop.StopPosition,\n                    Stops: [{\n                        StopUID: stop.StopUID,\n                    }],\n                };\n            });\n            return res;\n        })\n        .catch((error) => console.log(`error: ${stop_city_data[city]}公車站牌資料 `, error))\n\n}","import { useContext, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { city_data } from '../../api/TDX/city_data';\nimport { BusRouteContext } from '../../App';\nexport default function BusStationSearchList({ station_list, busStation, inputContent = \"\" }) {\n    const busRoute = useContext(BusRouteContext);\n    const [city, setCity] = useState(\"\");\n    const [prepare, setPrepare] = useState({});\n    useState(() => {\n        let p = {};\n        busStation.forEach(station => {\n            if (!p[station.City]) {\n                p[station.City] = [];\n            }\n            if (p[station.City].length < 500) {\n                p[station.City].push(station);\n            }\n        });\n        setPrepare(p);\n    }, [busStation]);\n    if (inputContent.length === 0 && city !== \"\") {\n        if (prepare[city]) {\n            station_list = prepare[city];\n        }\n    };\n    return (\n        <>\n            <div className=\"flex justify-between mx-4 my-1\">\n                <span></span>\n                <select className=\"bg-white\" onChange={(e) => setCity(e.target.value)}>\n                    <option value=\"\">全縣市</option>\n                    {Object.entries(city_data).map(city => (\n                        <option key={city[0]} value={city[0]}>{city[1]}</option>\n                    ))}\n                </select>\n            </div>\n            <div className=\"max-h-screen overflow-y-auto shadow-lg \" style={{ height: \"75vh\" }}>\n                {\n                    station_list.filter(data => {\n                        if (city === \"\" || data.City === city) {\n                            return data;\n                        } else {\n                            return false;\n                        }\n                    }).map(data => {\n                        return (\n                            <div key={data.StationUID} className=\"station-search-item\">\n                                <span className=\"station-name\">{data.StationName}</span><span className=\"station-city\">（{city_data[data.City]}）</span>\n                                <span className=\"station-address\">{data.StationAddress}</span>\n                                <br />\n                                <span>站點路線：</span>\n                                <div className=\"flex flex-wrap\">\n                                    {data.Stops.map((data, ind) => (\n                                        // RouteUID repeat\n                                        <Link key={ind} to={`/bus_estimated_time/${data.RouteUID}`}>\n                                            <span className=\"pin-icon-route-name\">{busRoute.find(route => route.RouteUID === data.RouteUID).RouteName.Zh_tw}</span>\n                                        </Link>\n                                    ))}\n                                </div>\n                            </div>\n                        )\n                    })\n                }\n            </div>\n        </>\n    );\n}","import { useContext, useEffect, useState } from \"react\";\nimport { getBusStationTrie, getNearByBusStation } from \"../api/TDX/Bus/BusStation\";\nimport { BusStationContext, UserLocationContext } from \"../App\";\nimport BusStationSearchList from \"../components/Search/BusStationSearchList\";\nimport { Trie } from \"../constants/Trie\";\nimport search_black_24dp from '../assets/icons/search_black_24dp.svg';\nimport { DEBUG } from \"../constants/debug\";\nimport BackPage from \"../components/Utils/BackPage\";\n\n\nfunction FindBusStationInput({ inputHandle }) {\n\n    return (\n        <div className=\"flex justify-center items-center\">\n            <div className=\"input-window flex justify-center items-center \">\n                <img src={search_black_24dp} className=\"lookup\" alt=\"尋找路線 serach icon\" />\n                <input className=\"input\" placeholder=\"請輸入站點名稱\" autoComplete=\"off\" onChange={e => inputHandle(e.target.value)}></input>\n            </div>\n        </div>\n    );\n}\n\nexport default function FindBusStation() {\n    const busStation = useContext(BusStationContext);\n    const [inputContent, setInputContent] = useState(\"\");\n    const [stationList, setStationList] = useState([]);\n    const [busStationTrie, setBusStationTrie] = useState(new Trie());\n\n    const userLocation = useContext(UserLocationContext);\n    const [nearByBusStation, setNearByBusStation] = useState([]);\n\n    useEffect(() => {\n        setNearByBusStation(getNearByBusStation(busStation, userLocation));\n    }, [busStation, userLocation]);\n\n    function getInputContent(content) {\n        setInputContent(content);\n    }\n\n    //Build Trie for keyword selection\n    useEffect(() => {\n        if (busStation) {\n            setBusStationTrie(getBusStationTrie(busStation))\n        }\n    }, [busStation]);\n\n    //Get candidates of station\n    useEffect(() => {\n        if (inputContent.length > 0) {\n            setStationList(busStationTrie.findAllIndices(inputContent).sort().filter(\n                (item, ind, arr) => ind === 0 || arr[ind - 1] !== arr[ind]).map(item_ind => busStation[item_ind])\n                // sort for keyword selection\n                .sort((station1, station2) => {\n                    return (station1.StationName.length < station2.StationName.length ? -1 : 1)\n                })\n            );\n        } else if (nearByBusStation.length > 0) {\n            setStationList(nearByBusStation);\n        } else {\n            const pick = Math.floor(busStation.length / 2);\n            setStationList(busStation.slice(pick, pick + 10));\n        }\n        DEBUG && console.log(stationList)\n    }, [inputContent, busStationTrie, busStation, nearByBusStation]);\n\n    // test busStationTrie.findAllIndices('307').forEach(item => console.log(busStation[item]));\n\n    return (\n        <section className=\"bg-white  pt-4 lg:pb-10 h-full\">\n            <BackPage />\n            <div className=\"view-border h-full flex flex-col\">\n                <FindBusStationInput inputHandle={getInputContent} />\n                <BusStationSearchList station_list={stationList} busStation={busStation} inputContent={inputContent} />\n            </div>\n        </section>\n    );\n\n}\n","export default __webpack_public_path__ + \"static/media/bus_c1.01261033.svg\";","export default __webpack_public_path__ + \"static/media/bus_c2.3a493e43.svg\";","export default __webpack_public_path__ + \"static/media/bus_c4.94f6594e.svg\";","export default __webpack_public_path__ + \"static/media/bus_c3.8737ceaf.svg\";","export default __webpack_public_path__ + \"static/media/bus_c5.475883a6.svg\";","export default function Banner() {\n    return (\n        <div className=\"banner\">\n            <article className=\"article\">\n                <h1 className=\"mt-12\">台灣公車動態</h1>\n                <p className=\"mt-4 text-gray-200\">時刻查詢系統</p>\n                <p className=\"mt-5 text-gray-400 tracking-normal text-xs lg:text-sm\">TAIWAN BUS+</p>\n            </article>\n        </div>\n    )\n}","import { useContext, useEffect, useState } from 'react';\nimport { MapContainer, Marker, Popup, TileLayer } from 'react-leaflet'\nimport { BusRouteContext, BusStationContext, UserLocationContext } from '../../App';\nimport pin from '../../assets/icons/pin.svg';\nimport bus from '../../assets/icons/directions_bus_filled_24dp.svg';\n\nimport { Icon } from 'leaflet';\nimport { getNearByBusStation } from '../../api/TDX/Bus/BusStation';\nimport { DEBUG } from '../../constants/debug';\nimport { Link } from 'react-router-dom';\n\nconst pin_icon = new Icon({\n    iconUrl: pin,\n    iconSize: [24, 24],\n    className: 'leaflet-marker-icon pin-icon red'\n});\n\nconst bus_icon = new Icon({\n    iconUrl: bus,\n    iconSize: [36, 36],\n    className: 'leaflet-marker-icon'\n})\n\n\n\n// Bus station data\n// {\n//     City,\n//     StationUID,\n//     StationName,\n//     StationEnName,\n//     StationPosition,\n//     StationAddress,\n//     Stops,\n// }\n\n// StationPosition: {\n//     PositionLat,\n//     PositionLon\n// }\n\n// Stops:[\n//     {\n//         StopUID\n//         RouteUID\n//     }\n// ]\n\nfunction PinNearByBusStationPosition({ nearByBusStation }) {\n    const busRoute = useContext(BusRouteContext);\n    return (\n        nearByBusStation.map(station => {\n            return (\n                <Marker key={station.StationUID} position={[station.StationPosition.PositionLat, station.StationPosition.PositionLon]} icon={bus_icon}>\n                    <Popup>\n                        <span className=\"pin-icon-station-name\">{station.StationName}</span><br />\n                        <span className=\"pin-icon-station-address\">{station.StationAddress}</span><br />\n                        {station.Stops.map((stop, ind) => (\n                            <Link key={stop.RouteUID} to={`/bus_estimated_time/${stop.RouteUID}`}>\n                                <span className=\"pin-icon-route-name\">{busRoute.find(route => route.RouteUID === stop.RouteUID).RouteName.Zh_tw}</span>\n                            </Link>\n                        ))}\n                    </Popup>\n                </Marker>\n            )\n        })\n    );\n}\n\n\nexport default function NearByBusStationMap() {\n    const userLocation = useContext(UserLocationContext);\n    const busStation = useContext(BusStationContext);\n    const [map, setMap] = useState(null);\n    const [nearByBusStation, setNearByBusStation] = useState([]);\n    useEffect(() => {\n        if (map) {\n            map.setView([userLocation.latitude, userLocation.longitude]);\n        }\n    }, [map, userLocation]);\n    useEffect(() => {\n        setNearByBusStation(getNearByBusStation(busStation, userLocation));\n    }, [busStation, userLocation]);\n\n    DEBUG && console.log('near by bus station', getNearByBusStation(busStation, userLocation));\n\n    return (\n        <MapContainer center={[22.9977325, 120.2141299]} zoom={16} scrollWheelZoom={false} whenCreated={setMap}>\n            <TileLayer\n                attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n                url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n            />\n            <Marker position={[userLocation.latitude, userLocation.longitude]} icon={pin_icon}>\n                <Popup>\n                    <div className=\"pin-here\">你在這裡</div>\n                    附近有<span className=\"text-blue-800 font-bold mx-1\">{nearByBusStation.length}</span>個站點\n                </Popup>\n            </Marker>\n            <PinNearByBusStationPosition nearByBusStation={nearByBusStation} />\n        </MapContainer>\n    )\n}","import BusEstimatedTime from \"../pages/BusEstimatedTime\";\nimport FindBusRoute from \"../pages/FindBusRoute\";\nimport FindBusStation from \"../pages/FindBusStation\";\nimport Home from \"../pages/Home\";\nimport LikedList from \"../pages/LikedList\";\nimport NearByBusStation from \"../pages/NearByBusStation\";\n\nconst routes = [{\n    path: '/',\n    exact: true,\n    component: Home,\n}\n, \n{\n    path: '/find_bus_route/',\n    exact: false,\n    component: FindBusRoute,\n}, {\n    path: '/bus_estimated_time/:RouteUID',\n    exact: false,\n    component: BusEstimatedTime,\n}, {\n    path: '/near_by_bus_station/',\n    exact: false,\n    component: NearByBusStation,\n},{\n    path:'/find_bus_station/',\n    exact: false,\n    component: FindBusStation,\n},{\n    path:'/liked_list/',\n    exact: false,\n    component: LikedList,\n}\n];\n\nexport default routes;","import { NavLink } from \"react-router-dom\";\nimport bus_c1 from '../assets/icons/bus_c1.svg';\nimport bus_c2 from '../assets/icons/bus_c2.svg';\nimport bus_c3 from '../assets/icons/bus_c3.svg';\nimport bus_c4 from '../assets/icons/bus_c4.svg';\nimport bus_c5 from '../assets/icons/bus_c5.svg';\nimport Banner from \"../components/Banner/Banner\";\n\n\nexport default function Home() {\n    return (\n        <div>\n            <Banner/>\n            <section className=\"view-border h-full lg:flex justify-between\">\n                <NavLink to='/find_bus_route/'>\n                    <div className=\"home-btn\">\n                        <img src={bus_c1} alt='公車圖案' />\n                        <span className=\"c1 ml-2\">尋找路線</span>\n                    </div>\n                </NavLink>\n                <NavLink to='/near_by_bus_station/'>\n                    <div className=\"home-btn\">\n                        <img src={bus_c5} alt='公車圖案' />\n                        <span className=\"c5 ml-2\">附近站點</span>\n                    </div>\n                </NavLink>\n                <NavLink to='/find_bus_station/'>\n                    <div className=\"home-btn\">\n                        <img src={bus_c2} alt='公車圖案' />\n                        <span className=\"c2 ml-2\">站點查詢</span>\n                    </div>\n                </NavLink>\n                <NavLink to='/liked_list/'>\n                    <div className=\"home-btn\">\n                        <img src={bus_c4} alt='公車圖案' />\n                        <span className=\"c4 ml-2\">收藏清單</span>\n                    </div>\n                </NavLink>\n\n            </section>\n        </div>\n    )\n}","import NearByBusStationMap from \"../components/Map/NearByBusStationMap\";\n\nimport BackPage from \"../components/Utils/BackPage\";\n\nexport default function NearByBusStation() {\n\n    return (\n        <section className=\"h-full\">\n            <div >\n                <BackPage />\n                <div className=\"  flex justify-center items-center h-20\">\n                    <div className=\"bus-stationname\">\n                        附近的公車站點\n                    </div>\n                </div>\n            </div>\n            <div className=\"\">\n                <div className=\"w-screen  max-w-full lg:shadow-lg\" style={{ height: \"70vh\" }} >\n                    <NearByBusStationMap />\n                </div>\n            </div>\n        </section>\n    );\n\n}","import { useContext} from \"react\";\nimport { BusRouteContext } from \"../App\";\nimport BusRouteSearchList from \"../components/Search/BusRouteSearchList\";\nimport BackPage from \"../components/Utils/BackPage\";\n\nexport default function LikedList() {\n    const busRoute = useContext(BusRouteContext);\n    const likedRouteList = busRoute.length && localStorage.getItem(\"liked_bus_route_list\") ? JSON.parse(localStorage.getItem(\"liked_bus_route_list\")).map(RouteUID => busRoute.find(route => route.RouteUID === RouteUID)) : [];\n    return (\n        <section className=\"bg-white  pt-4 lg:pb-10 h-full\">\n            <BackPage />\n            <div className=\"view-border h-full flex flex-col\">\n                <div className=\"max-h-screen overflow-y-auto shadow-lg \" style={{ height: \"75vh\" }}>\n                    {likedRouteList && likedRouteList.length > 0 ? <BusRouteSearchList route_list={likedRouteList} busRoute={[]} inputContent=\"*\" /> : <div className=\"flex justify-center items-center my-10\">您還沒有收藏路線</div>}\n                </div>\n            </div>\n        </section>\n    )\n}","export function getExpireTime(milliseconds) {\n    const expire_time = new Date();\n    const shift = expire_time.getTime() + milliseconds;\n    expire_time.setTime(shift);\n    return expire_time.toUTCString();\n}","import { getAllBusCityStation } from \"../../api/TDX/Bus/BusStation\";\nimport LZString from \"lz-string\";\nimport { DEBUG } from \"../../constants/debug\";\nimport { useEffect, useState } from \"react\";\nimport { getExpireTime } from \"./util\";\n\nlet messages = [];\nmessages.push(\"你知道嗎？北一女中的公車站牌其實叫作一女中？趕緊到【站點查詢】試試吧！\");\nmessages.push(\"跳蛙公車其實是會開上高速公路的公車喔！\")\nmessages.push(\"到【尋找路線】查查看新北市F開頭的公車吧！市民不用錢喔！\")\n\nexport default function StoreBusStation({ setBusStation }) {\n    const [loading, setLoading] = useState(true);\n    useEffect(() => {\n        const saved_bus_station = JSON.parse(localStorage.getItem(\"bus_station\") && LZString.decompressFromBase64(localStorage.getItem(\"bus_station\")));\n        if (!saved_bus_station || !saved_bus_station.data || new Date().getTime() > new Date(saved_bus_station.expire_time)) {\n            DEBUG && console.log('restore bus_station');\n            getAllBusCityStation()\n                .then(res => {\n                    setBusStation && setBusStation(res);\n                    localStorage.setItem(\"bus_station\", LZString.compressToBase64(JSON.stringify({\n                        data: res,\n                        expire_time: getExpireTime(24 * 3600 * 1000)\n                    })));\n                })\n                .then(() => {\n                    setLoading(false);\n                });\n        } else {\n            DEBUG && console.log('current bus_station size:', localStorage.getItem(\"bus_station\").length / 1024 / 1024, 'MB');\n            DEBUG && console.log(`bus_staion expire_time: ${saved_bus_station.expire_time}`);\n            setBusStation && setBusStation(saved_bus_station.data);\n            setLoading(false);\n        }\n    }, [setBusStation]);\n\n    return (loading &&\n        <div className=\"bg-white font-bold opacity-90 z-50 w-full h-full fixed flex flex-col items-center justify-center\">\n            <p className=\"text-center mb-2 tracking-widest \">資料更新中…</p>\n            <p className=\"text-center mb-10 tracking-widest\">第一次更新需約15秒的時間</p>\n            {messages.map((message,ind) => {\n                return <p key={ind} className=\"w-1/2 transition-all my-2 font-bold tracking-widest\">{ind+1} {message}</p>\n            })}\n        </div>\n    );\n}","import { useEffect, useState } from \"react\";\nimport { DEBUG } from \"../../constants/debug\";\n\nfunction getLocation(setUserLocation, prevLocation, setPrevLocation) {\n    if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(\n            function (position) {\n                if (needUpdate(prevLocation, position.coords)) {\n                    setUserLocation(position.coords);\n                    setPrevLocation(position.coords);\n                } else {\n                    DEBUG && console.log(\"UserLocation: Do not need update.\")\n                }\n            },\n            function (e) {\n                const msg = e.code;\n                const dd = e.message;\n                console.error(msg)\n                console.error(dd)\n            }\n        )\n    }\n}\n\n// update when distance is over 5m.\nfunction needUpdate(prevLocation, currentLocation) {\n    const x = (currentLocation.longitude - prevLocation.longitude) * 100000;\n    const y = (currentLocation.latitude - prevLocation.latitude) * 100000;\n    return Math.pow(x, 2) + Math.pow(y, 2) > 25;\n}\n\nexport default function PosUserLocation({ setUserLocation, period = 30 }) {\n    const [prevLocation, setPrevLocation] = useState({ longitude: 0, latitude: 0 });\n    useEffect(() => {\n        getLocation(setUserLocation, prevLocation, setPrevLocation);\n        let periodic_action = setInterval(() => {\n            getLocation(setUserLocation, prevLocation, setPrevLocation);\n        }, period * 1000);\n        return () => {\n            clearInterval(periodic_action);\n        };\n    }, [setUserLocation, period, prevLocation]);\n    return null;\n}","import LZString from \"lz-string\";\nimport { DEBUG } from \"../../constants/debug\";\nimport { useEffect } from \"react\";\nimport { getAllBusCityRoute } from \"../../api/TDX/Bus/BusRoute\";\nimport { getExpireTime } from \"./util\";\n\n\n\nexport default function StoreBusRoute({ setBusRoute }) {\n    useEffect(() => {\n        const saved_bus_route = JSON.parse(localStorage.getItem(\"bus_route\") && LZString.decompressFromBase64(localStorage.getItem(\"bus_route\")));\n        if (!saved_bus_route || !saved_bus_route.data || new Date().getTime() > new Date(saved_bus_route.expire_time)) {\n            DEBUG && console.log('restore bus_route');\n            getAllBusCityRoute()\n                .then(res => {\n                    setBusRoute && setBusRoute(res);\n                    localStorage.setItem(\"bus_route\", LZString.compressToBase64(JSON.stringify({\n                        data: res,\n                        expire_time: getExpireTime(24 * 3600 * 1000)\n                    })));\n                })\n        } else {\n            DEBUG && console.log('current bus_route size:', localStorage.getItem(\"bus_route\").length / 1024 / 1024, 'MB');\n            DEBUG && console.log(`bus_staion expire_time: ${saved_bus_route.expire_time}`);\n            setBusRoute && setBusRoute(saved_bus_route.data);\n        }\n    }, [setBusRoute]);\n\n\n    return null;\n}","export default __webpack_public_path__ + \"static/media/logo.606790e7.svg\";","import { useState } from 'react';\nimport { NavLink } from 'react-router-dom';\nimport logo from '../../assets/icons/logo.svg';\nimport { Pivot as Hamburger } from 'hamburger-react'\n\nexport default function Header() {\n    const [isOpen, setOpen] = useState(false);\n    return (\n        <div className=\"relative\">\n            <div className=\"header \">\n                <NavLink to=\"/\">\n                    <img src={logo} alt=\"logo\" />\n                </NavLink>\n\n                <div className=\"flex\">\n                    <div className=\"hidden lg:block\">\n                        <ul className=\" bg-white flex justify-between items-center\" onClick={() => setOpen(false)}>\n                            <li className=\"mx-4\">\n                                <NavLink to='/find_bus_route/' className='header-nav-btn'>\n                                    尋找路線\n                                </NavLink>\n                            </li>\n                            <li className=\"mx-4\">\n                                <NavLink to='/near_by_bus_station/' className='header-nav-btn'>\n                                    附近站點\n                                </NavLink>\n                            </li>\n                            <li className=\"mx-4\">\n                                <NavLink to='/find_bus_station/' className='header-nav-btn'>\n                                    站點查詢\n                                </NavLink>\n                            </li>\n                            <li className=\"mx-4\">\n                                <NavLink to='/liked_list/' className='header-nav-btn'>\n                                    收藏清單\n                                </NavLink>\n                            </li>\n                        </ul>\n                    </div>\n                    <div className=\"lg:hidden\">\n                        <Hamburger size={20} toggled={isOpen} toggle={setOpen} />\n                    </div>\n                </div>\n            </div>\n            <HamburgerMenu isOpen={isOpen} setOpen={setOpen} />\n        </div>\n    );\n}\n\nfunction HamburgerMenu({ isOpen, setOpen }) {\n    if (isOpen) {\n        return (\n            <ul className=\"absolute bg-white shadow-lg top-16 right-0 px-8 z-30 lg:hidden\" onClick={() => setOpen(false)}>\n                <li className='mt-5 mb-5 '>\n                    <NavLink to='/find_bus_route/' className='header-nav-btn'>\n                        尋找路線\n                    </NavLink>\n                </li>\n                <li className='mb-5'>\n                    <NavLink to='/near_by_bus_station/' className='header-nav-btn'>\n                        附近站點\n                    </NavLink>\n                </li>\n                <li className='mb-5'>\n                    <NavLink to='/find_bus_station/' className='header-nav-btn'>\n                        站點查詢\n                    </NavLink>\n                </li>\n                <li className='mb-5'>\n                    <NavLink to='/liked_list/' className='header-nav-btn'>\n                        收藏清單\n                    </NavLink>\n                </li>\n            </ul>\n\n        );\n    } else {\n        return <span></span>;\n    }\n}\n","export default function Footer() {\n    return (\n        <div className=\"mt-auto bg-gray-700 flex justify-center items-center h-8 lg:h-16 flex-grow-0 flex-shrink-0 \">\n            <span className=\"text-xs text-white\">Copyright © 2021 台灣公車 e 點通 &amp; Z.M. All rights reserved.</span>\n        </div>\n    )\n}","import { renderRoutes } from 'react-router-config';\nimport routes from './router';\nimport './assets/styles/index.scss';\nimport StoreBusStation from './components/LocalStorage/StoreBusStation';\nimport { createContext, useContext, useState } from 'react';\nimport PosUserLocation from './components/Location/PosUserLocation';\nimport StoreBusRoute from './components/LocalStorage/StoreBusRoute';\nimport Header from './components/Header/Header';\nimport Footer from './components/Footer/Footer';\n\n\nexport const BusStationContext = createContext([]);\nexport const BusRouteContext = createContext([]);\nexport const UserLocationContext = createContext({ longitude: 121.5410178, latitude: 25.0208745 });\nfunction App() {\n  const [busStation, setBusStation] = useState([]);\n  const [busRoute, setBusRoute] = useState([]);\n  const [userLocation, setUserLocation] = useState(useContext(UserLocationContext));\n  return (\n    <div className=\"App\" >\n\n      <PosUserLocation setUserLocation={setUserLocation} />\n      <StoreBusStation setBusStation={setBusStation} />\n      <StoreBusRoute setBusRoute={setBusRoute} />\n      <UserLocationContext.Provider value={userLocation}>\n        <BusStationContext.Provider value={busStation}>\n          <BusRouteContext.Provider value={busRoute}>\n            <div className='min-h-screen flex flex-col flex-nowrap' >\n            <Header />\n              {renderRoutes(routes)}\n            <Footer/>\n            </div>\n          </BusRouteContext.Provider>\n        </BusStationContext.Provider>\n      </UserLocationContext.Provider>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import { useEffect } from 'react';\nimport { withRouter } from 'react-router-dom';\n\nfunction ScrollToTop({ history }) {\n    useEffect(() => {\n        const unlisten = history.listen(() => {\n            window.scrollTo(0, 0);\n        });\n        return () => {\n            unlisten();\n        }\n    }, []);\n\n    return (null);\n}\n\nexport default withRouter(ScrollToTop);","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { HashRouter } from 'react-router-dom';\nimport './assets/styles/index.scss';\nimport 'swiper/swiper-bundle.min.css';\nimport 'leaflet/dist/leaflet.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport ScrollToTop from './components/ScrollToTop';\n\nReactDOM.render(\n  <React.StrictMode>\n    <HashRouter>\n    <ScrollToTop />\n      <App />\n    </HashRouter>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\nreportWebVitals();\n"],"sourceRoot":""}